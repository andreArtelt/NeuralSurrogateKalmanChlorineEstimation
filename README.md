# Neural Surrogate Model in an Extended Kalman Filter for Chlorine Concentration State Estimation in Water Distribution Systems
This repository contains the implementation of the experiments from the paper [Neural Surrogate Model in an Extended Kalman Filter for Chlorine Concentration State Estimation in Water Distribution Systems](TODO-LinkToPaper) presented & published at SysTol 2025 by André Artelt, Janine Strotherm, Luca Hermes, Barbara Hammer

## Abstract

Water utilities around the world typically use chlorine as the main disinfectant for ensuring high-quality drinking water. Usually, a few fixed sensors monitor water quality by detecting changes in parameters like chlorine residuals, guiding chlorination strategies. However, limited sensor coverage leaves most parts of the network unmonitored. Additionally, rapid urban growth and climate change complicate water quality dynamics, challenging conventional methods for sparse to dense state estimation.
In this work, we propose a neural network based surrogate model for efficiently obtaining time-dependent approximations of the chlorine concentration dynamics in a water distribution system. We incorporate this surrogate model into an extended Kalman filter to estimate all chlorine concentration states on the basis of only a few sensors. We perform extensive empirical evaluations on popular benchmark water distribution systems from the literature.

## Experiments

Before running the experiments, the data must be generated by running the Python script [create_data.py](create_data.py).
Next, the surrogate models must be fitted by running [fit_surrogates.py](fit_surrogates.py).
Finally, the Python script [run_exp_state_estimation.py](run_exp_state_estimation.py) runs all experiments as described in the paper, prints the results, and stores them in this folder.

## Requirements

- Python >= 3.9
- Packages as listed in [REQUIREMENTS.txt](REQUIREMENTS.txt)

## License

MIT license - See [LICENSE](LICENSE).

## How to Cite?

```
@article{NeuralSurrogateKalmanChlorineEstimationArtelt2025,
        author = {André Artelt and JanineStrotherm and Luca Hermes and Barbara Hammer},
        title = {{Neural Surrogate Model in an Extended Kalman Filter for Chlorine Concentration State Estimation in Water Distribution Systems}},
        year = {2025}
    }
```
